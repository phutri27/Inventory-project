<html>
    <head>
        <link rel="stylesheet" href="/styles.css">
        <title><%= title %></title>
    </head>
    <body>
        <div>
            <div class="add-btn">
                <a href="/add_genres">
                    <button>Add genre</button>
                </a>
                <a href="/add_movies">
                    <button>Add movie</button>
                </a>
            </div>
            <div class="genre-container">
                <% genres.forEach((genre) => { %>
                    <% let isColor; %>
                    <% if (movies && movies.length) { %>
                        <% isColor = (genre.id == genred ); %>
                    <% } %>
                    <div class="genre-container-inner">
                        <form action="/genres/<%= genre.id %>" method="GET">
                            <button type="submit" class="genre-btn <%= isColor ? "hold" : "" %>"><%= genre.genre_name %></button>
                        </form>
                        <div class="util" data-genre-id="<%= genre.id %>">
                            <a href="/edit_genres/<%= genre.id %>">
                                <button>Edit</button>
                            </a>
                            <form action="/<%= genre.id %>/delete" method="POST">
                                <button type="submit">Delete</button>
                            </form>
                        </div>
                    </div>
                
                <% }) %>
            </div>
        </div>
        <div class="container">
            <div class="movie-container">
                <% if (movies && movies.length) { %>
                    <% movies.forEach((movie) => { %>
                        <div class="movie-con">
                            <div class="movie">
                                <p><%= movie.movie_name %></p>
                                <div>
                                <img src="<%= movie.poster %>" alt="<%= movie.movie_name %> Poster" class="posterImg">
                                </div>
                                <div class="movie-genre-div">
                                    <% movie.movieGenres.forEach((name) => { %>
                                        <div class="movie-genre-div-inner"><%= name %></div>
                                    <% }) %>
                                </div>
                                <div class="movie-util">
                                    <form action="/<%= movie.id %>/deleteMovie" method="POST">
                                        <input type="hidden" name="genreId" id="genreId" value="<%= genred %>">
                                        <button type="submit">Delete</button>
                                    </form>
                                    <a href="/edit_movie/<%= movie.id %>">
                                        <button>Edit</button>
                                    </a>
                                </div>
                            </div>
                        </div>
                <% }) %>
            <% } %>
            </div>
        </div>
        <script>
            const btn = document.querySelectorAll(".genre-btn")
            btn.forEach((elem) => {
                elem.addEventListener('click', (e) =>{
                    document.querySelector(".hold")?.classList.remove("hold")
                    elem.classList.add("hold")
                })
            })
        </script>
    </body>
</html>